# ThermalCam Code Summary

ë³¸ ë¬¸ì„œëŠ” `thermalcam` í”„ë¡œì íŠ¸ì˜ ì „ì²´ Python ì½”ë“œ êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ í•­ëª©ì„ í¬í•¨í•©ë‹ˆë‹¤:

1. ì •ì˜ëœ ëª¨ë“  í•¨ìˆ˜ ë° í´ë˜ìŠ¤ ì´ë¦„
2. ê° í•¨ìˆ˜/í´ë˜ìŠ¤ì˜ ì¸ì(ë§¤ê°œë³€ìˆ˜)
3. ê° í•­ëª©ì˜ ì—­í• ì„ í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½
4. ê° íŒŒì¼ì´ ì „ì²´ í”„ë¡œê·¸ë¨ íë¦„ì—ì„œ ìˆ˜í–‰í•˜ëŠ” ì—­í•  ìš”ì•½

---

## ğŸ“ thermalcam/core

| íŒŒì¼ëª…             | êµ¬ì„± ìš”ì†Œ                                                           | ì¸ì                                    | ì—­í•  ìš”ì•½ |
| ------------------ | ------------------------------------------------------------------- | --------------------------------------- | --------- |
| `alarm.py`         | `fetch_alarm_conditions(ip, user_id, user_pw)`                      | ì¹´ë©”ë¼ì—ì„œ ROI ì•ŒëŒ ì¡°ê±´ì„ ë¶ˆëŸ¬ì˜´       |           |
|                    | `evaluate_alarms(rois, thermal_data)`                               | ì‹¤ì‹œê°„ ì˜¨ë„ì™€ ì•ŒëŒ ì¡°ê±´ ë¹„êµ í‰ê°€       |           |
| `camera_client.py` | `ThermalReceiver(host, port, data_store, on_roi_refresh, roi_data)` | TCP ë°ì´í„° ìˆ˜ì‹  ë° ì•ŒëŒ í‰ê°€ ì²˜ë¦¬       |           |
| `focus.py`         | `FocusController(get_ip_func, get_speed_func)`                      | ì¹´ë©”ë¼ ì´ˆì  ì¡°ì ˆ ëª…ë ¹ ë°˜ë³µ ì „ì†¡         |           |
| `frame_reader.py`  | `FrameReader(url, delay_sec)`                                       | RTSP ì˜ìƒ ìŠ¤íŠ¸ë¦¬ë° + ì§€ì—° í”„ë ˆì„ ì œê³µ   |           |
| `roi.py`           | `fetch_all_rois(ip, user_id, user_pw)`                              | ROI/ì•ŒëŒ/ISO ë°ì´í„° íŒŒì‹± í›„ ë¦¬ìŠ¤íŠ¸ ë°˜í™˜ |           |
|                    | `draw_rois(frame, rois, thermal_data, scale_x, scale_y)`            | í”„ë ˆì„ ìœ„ì— ROI ë° ì•ŒëŒ ê²°ê³¼ ì‹œê°í™”     |           |
| `yolo.py`          | `YOLODetector(model_path='yolov8n.pt')`                             | YOLOv8 ëª¨ë¸ ë¡œë”© ë° ê°ì²´ íƒì§€ ìˆ˜í–‰      |           |
|                    | `detect(frame)`                                                     | ê°ì²´ ê°ì§€ ê²°ê³¼ ë°˜í™˜                     |           |
|                    | `draw_detections(frame, detections)`                                | ê°ì²´ íƒì§€ ë°•ìŠ¤ë¥¼ í”„ë ˆì„ì— í‘œì‹œ          |           |

**ì—­í•  ìš”ì•½:** ì„¼ì„œ/ROI/ì•ŒëŒ ë“± í•µì‹¬ ê¸°ëŠ¥ê³¼ ì˜ìƒ ì—°ì‚° ì²˜ë¦¬ ë‹´ë‹¹

---

## ğŸ“ thermalcam/ui

### ğŸ“„ `main_window.py`

- `OpenCVViewer` í´ë˜ìŠ¤:

  - RTSP ì˜ìƒ í‘œì‹œ, ROI ì‹œê°í™”, TCP ì˜¨ë„ ìˆ˜ì‹ , YOLO íƒì§€ ë“± ì „ì²´ ê¸°ëŠ¥ í†µí•© GUI

### ğŸ“„ `graph_window.py`

- `GraphWindow(ip)` í´ë˜ìŠ¤:

  - TCP ì‹¤ì‹œê°„ ì˜¨ë„ ìˆ˜ì¹˜ë¥¼ matplotlib ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•¨

### ğŸ“„ `stream_handler.py`

| í•¨ìˆ˜                   | ì¸ì | ì—­í•                                  |
| ---------------------- | ---- | ------------------------------------ |
| `start_stream(viewer)` | ì—†ìŒ | ROI ë©”íƒ€ì •ë³´ ë¡œë“œ ë° RTSP + TCP ì‹œì‘ |
| `stop_stream(viewer)`  | ì—†ìŒ | ëª¨ë“  ìŠ¤íŠ¸ë¦¼/íƒ€ì´ë¨¸ ì¢…ë£Œ              |
| `update_frame(viewer)` | ì—†ìŒ | í”„ë ˆì„ì„ ê°±ì‹ í•˜ê³  ROI/YOLO ì ìš©      |

### ğŸ“„ `roi_display_handler.py`

| í•¨ìˆ˜                                                 | ì¸ì                           | ì—­í•                    |
| ---------------------------------------------------- | ------------------------------ | ---------------------- |
| `init_roi_labels(viewer)`                            | ì—†ìŒ                           | ROI í…Œì´ë¸” ë¼ë²¨ ì´ˆê¸°í™” |
| `process_roi_display(viewer, rgb, scale_x, scale_y)` | ROI ì•ŒëŒ ì‹œê°í™”, ë¼ë²¨ ì—…ë°ì´íŠ¸ |                        |
| `refresh_rois(viewer)`                               | ROI/ì•ŒëŒ ì¡°ê±´ ê°±ì‹  ì²˜ë¦¬        |                        |

### ğŸ“„ `yolo_handler.py`

- `handle_yolo_detection(viewer, rgb)`: YOLO íƒì§€ + ê°ì§€ ì‹œ ìº¡ì²˜ ì €ì¥

---

## ğŸ“ dialogs/camera_controls

| íŒŒì¼ëª…           | í´ë˜ìŠ¤                    | ì¸ì                 | ì—­í•  ìš”ì•½                                |
| ---------------- | ------------------------- | -------------------- | ---------------------------------------- |
| `correction.py`  | `CorrectionControlPopup`  | ip, user_id, user_pw | ì˜¨ë„ ë³´ì • íŒŒë¼ë¯¸í„° ì„¤ì • UI               |
| `display.py`     | `DisplayControlPopup`     | ip, user_id, user_pw | ì˜ìƒ í‘œì‹œ ê´€ë ¨ ì„¤ì • UI                   |
| `enhancement.py` | `EnhancementControlPopup` | ip, user_id, user_pw | ì˜ìƒ í’ˆì§ˆ í–¥ìƒ ê´€ë ¨ UI                   |
| `image.py`       | `ImageControlPopup`       | ip, user_id, user_pw | ìƒ‰ìƒ, ë°ê¸°, ì½˜íŠ¸ë¼ìŠ¤íŠ¸ ë“± ì´ë¯¸ì§€ ì„¤ì • UI |
| `nuc.py`         | `NUCControlPopup`         | ip, user_id, user_pw | NUC (ë¹„ê· ì¼ ë³´ì •) ì„¤ì • UI                |

---

## ğŸ“ dialogs/roi_editor

| íŒŒì¼ëª…                   | êµ¬ì„± ìš”ì†Œ                                        | ì¸ì                                 | ì—­í•  ìš”ì•½ |
| ------------------------ | ------------------------------------------------ | ------------------------------------ | --------- |
| `roi_editor_main.py`     | `SetROIPopup(ip, user_id, user_pw, main_window)` | ROI ì„¤ì • íŒì—… ì „ì²´ êµ¬ì„±ê³¼ ì—°ê²°       |           |
| `roi_loader.py`          | `ROILoader(...)`                                 | ROI/ì•ŒëŒ/ISO ë°ì´í„° í…Œì´ë¸”ì— ë¡œë”©    |           |
| `roi_loader_thread.py`   | `ROILoaderThread(...)`                           | RTSP í”„ë ˆì„ + ROI ë³‘ë ¬ ë¡œë”©          |           |
| `roi_drawer.py`          | `ROIDrawer(...)`                                 | í…Œì´ë¸” ê¸°ë°˜ ROI ì‚¬ê°í˜• ì´ë¯¸ì§€ì— ê·¸ë¦¼ |           |
| `roi_capture_handler.py` | `ROICaptureHandler(...)`                         | ROI ì§ì ‘ ê·¸ë¦¬ê¸° ê²°ê³¼ í…Œì´ë¸” ë°˜ì˜     |           |
| `roi_saver.py`           | `ROISaver(...)`                                  | ROI/ì•ŒëŒ/ISO ì„¤ì •ì„ ì¹´ë©”ë¼ì— ì €ì¥    |           |
| `roi_sync.py`            | `ROISyncManager(...)`                            | ì„¸ í…Œì´ë¸” ê°„ ì‚¬ìš© ìƒíƒœ ë™ê¸°í™” ì²˜ë¦¬   |           |
| `rtsp_utils.py`          | `load_rtsp_frame(ip)`                            | RTSP ìŠ¤íŠ¸ë¦¼ì—ì„œ í”„ë ˆì„ 1ì¥ ìº¡ì²˜      |           |

---

## ğŸ“ widgets

| íŒŒì¼ëª…                  | í´ë˜ìŠ¤            | ì—­í•  ìš”ì•½                                                       |
| ----------------------- | ----------------- | --------------------------------------------------------------- |
| `roi_capture_widget.py` | `ROICaptureLabel` | ROI ì§ì ‘ ë“œë˜ê·¸/ì´ë™/ì„ íƒ UI ìœ„ì ¯, paintEvent ì»¤ìŠ¤í„°ë§ˆì´ì§• í¬í•¨ |

---

## ğŸ“„ cli.py

| í•¨ìˆ˜     | ì—­í•  ìš”ì•½                                                         |
| -------- | ----------------------------------------------------------------- |
| `main()` | `QApplication` ì‹¤í–‰ ë° `OpenCVViewer` ë„ì›€ (í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì§„ì…ì ) |

---

## ğŸ“‹ ëˆ„ë½ í™•ì¸ (structure.txt ê¸°ì¤€)

- âœ… `thermalcam/core` â†’ ì „ë¶€ í¬í•¨ë¨
- âœ… `thermalcam/ui` â†’ `dialogs`, `widgets`, ê° ê°œë³„ py íŒŒì¼ í¬í•¨ë¨
- âœ… `resources/icons`/`models`/`ui` ë“±ì€ `.ui`/`.pt`/`.gif`ë¡œ ì½”ë“œ ìš”ì•½ ì œì™¸ ëŒ€ìƒ
- âœ… ì‹¤í–‰ ì§„ì…ì  `cli.py` í¬í•¨ë¨

âœ… ìµœì¢…ì ìœ¼ë¡œ ëª¨ë“  ì£¼ìš” `.py` ì½”ë“œ íŒŒì¼ ë¶„ì„ ë° ìš”ì•½ ì™„ë£Œ.
